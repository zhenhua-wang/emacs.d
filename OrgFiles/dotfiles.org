#+title: Dotfiles
#+author: Zhenhua Wang
#+STARTUP: overview
#+PROPERTY: header-args :mkdirp yes
-----
* XKB
Copy to ~/etc/X11/xorg.conf.d/00-keyboard.conf~
#+HEADER: :tangle "no"
#+begin_src emacs-lisp
Section "InputClass"
        Identifier "system-keyboard"
        MatchIsKeyboard "on"
        Option "XkbLayout" "us"
        Option "XkbOptions" "caps:ctrl_modifier,altwin:swap_lalt_lwin"
EndSection
#+end_src

* Xresources
For Xft.dpi, using integer multiples of 96 usually works best, e.g. 192 for 200% scaling.
#+HEADER: :tangle (let ((xresources (expand-file-name "Xresources" user-emacs-directory))) (if (file-exists-p xresources) "no" xresources))
#+begin_src conf
Xft.dpi:   192
#+end_src

* EXWM
#+HEADER: :tangle (if (eq system-type 'gnu/linux) "/sudo::/usr/share/xsessions/EXWM.desktop" "no")
#+begin_src conf
[Desktop Entry]
Name=EXWM
Comment=Emacs Window Manager
Exec=sh /home/zhenhua/.emacs.d/exwm/start-exwm.sh
TryExec=sh
Type=Application
X-LightDM-DesktopName=exwm
DesktopNames=exwm
#+end_src

* SDDM
#+HEADER: :tangle (if (eq system-type 'gnu/linux) "/sudo::/etc/sddm.conf" "no")
#+begin_src conf
[Theme]
Current=catppuccin-frappe
CursorTheme=Breeze
#+end_src

* Rprofile
#+HEADER: :tangle "~/.Rprofile"
#+begin_src conf
## don't show gui menu
options(menu.graphics=FALSE)
#+end_src

* Kitty
#+HEADER: :tangle (if (eq system-type 'gnu/linux) "~/.config/kitty/kitty.conf" "no")
#+begin_src conf
# default conf
font_family      Noto Sans Mono
bold_font        Noto Sans Mono Bold
italic_font      Noto Sans Mono Italic
bold_italic_font Noto Sans Mono Bold Italic
font_size        15.0
background       #272829
# keymap
map cmd+c       copy_to_clipboard
map cmd+v       paste_from_clipboard
#+end_src

* Dunst
#+HEADER: :tangle (if (eq system-type 'gnu/linux) "~/.config/dunst/dunstrc" "no")
#+begin_src conf
[global]
monitor = 0
follow = mouse
origin = top-right
offset = 10x48
corner_radius = 0
scale = 0
notification_limit = 0
progress_bar = true
progress_bar_height = 80
progress_bar_frame_width = 4
progress_bar_min_width = 300
progress_bar_max_width = 300
indicate_hidden = yes
transparency = 0
separator_height = 2
text_icon_padding = 0
frame_width = 4
gap_size = 0
separator_color = frame
sort = yes
idle_threshold = 120
font = Noto Sans Mono 12
line_height = 2
markup = full
format = %s\n%b
alignment = left
vertical_alignment = center
show_age_threshold = 60
ellipsize = middle
ignore_newline = no
stack_duplicates = true
hide_duplicate_count = false
show_indicators = yes
enable_recursive_icon_lookup = true
icon_position = left
min_icon_size = 24
max_icon_size = 48
sticky_history = yes
history_length = 20
browser = /usr/bin/xdg-open
always_run_script = true
mouse_left_click = do_action
mouse_middle_click = close_all
mouse_right_click = close_current
title = Dunst
class = Dunst

[urgency_low]
timeout = 2
background = "#1E2128"
foreground = "#ABB2BF"
frame_color = "#292d37"

[urgency_normal]
timeout = 5
background = "#1E2128"
foreground = "#ABB2BF"
frame_color = "#292d37"

[urgency_critical]
timeout = 0
background = "#1E2128"
foreground = "#E06B74"
frame_color = "#E06B74"
#+end_src

* Picom
#+HEADER: :tangle (if (eq system-type 'gnu/linux) "~/.config/picom.conf" "no")
#+begin_src conf
fading = false;
fade-in-step = 1;
fade-out-step = 0.03;
fade-exclude = ["class_g = 'Emacs'"];
# opacity-rule = [
#   "90:class_g = 'kitty' && focused",
#   "40:class_g = 'kitty' && !focused",
# ];
# blur: {
#       method = "dual_kawase";
#       strength = 10;
#       background = false;
#       background-frame = false;
#       background-fixed = false;
# }
# backend = "glx";
#+end_src

* Vterm
#+HEADER: :tangle "~/.cache/emacs/vterm_conf.sh"
#+begin_src sh
# vterm working directory tracking
function vterm_printf() {
    if [ -n "$TMUX" ] && ([ "${TERM%%-*}" = "tmux" ] || [ "${TERM%%-*}" = "screen" ]); then
        # Tell tmux to pass the escape sequences through
        printf "\ePtmux;\e\e]%s\007\e\\" "$1"
    elif [ "${TERM%%-*}" = "screen" ]; then
        # GNU screen (screen, screen-256color, screen-256color-bce)
        printf "\eP\e]%s\007\e\\" "$1"
    else
        printf "\e]%s\e\\" "$1"
    fi
}
function vterm_prompt_end() {
    vterm_printf "51;A$(whoami)@$(hostname):$(pwd)"
}
setopt PROMPT_SUBST
export PROMPT=$PROMPT'%{$(vterm_prompt_end)%}'
#+end_src
